import{a as Q,b as G,c as $}from"./chunk-GJY3UEER.js";import{a as X}from"./chunk-RS2GEYJU.js";import{a as L}from"./chunk-G5KA7DMQ.js";import{a as j}from"./chunk-V6KGQEPR.js";import{a as z}from"./chunk-T32ATWVE.js";import{b as B,f as R,g as C,h as q,j as h,l as F,m as I,n as U,r as N}from"./chunk-EMUXDAZT.js";import{Aa as u,Ab as D,Ba as m,Da as b,Ea as y,Fa as x,G as O,I as p,J as g,Ma as s,Na as w,Ra as M,X as V,Y as E,Z as c,ca as f,e as W,ea as k,ia as S,jb as P,mb as H,qa as T,ra as A,sa as d,ta as n,ua as r,va as v,ya as _}from"./chunk-QQJZZCOM.js";var Y=W(X());var Z=["backgroundVideo"],ee=["carousel"],te=(a,e)=>e.id;function ie(a,e){if(a&1){let t=_();n(0,"button",25),u("click",function(){p(t);let o=m(2).$implicit,l=m();return g(l.deleteSlider(o.id))}),s(1,"Remove"),r()}}function oe(a,e){if(a&1){let t=_();n(0,"button",26),u("click",function(){p(t);let o=m(2).$implicit,l=m();return g(l.goToUpdateSlider(o.id))}),s(1,"Update"),r()}}function ne(a,e){if(a&1&&(n(0,"div",17)(1,"div",18),v(2,"img",19),r(),n(3,"div",20)(4,"h3",21),s(5),r(),n(6,"p"),s(7),r(),n(8,"div",22),S(9,ie,2,0,"button",23)(10,oe,2,0,"button",24),r()()()),a&2){let t=m().$implicit,i=m();c(2),d("src",M("",i.imageApi,"",t.imageUrl),V),c(3),w(t.title),c(2),w(t.header),c(2),d("ngIf",i.roles()),c(),d("ngIf",i.roles())}}function re(a,e){a&1&&S(0,ne,11,7,"ng-template",10)}var K=class a{constructor(e,t,i,o){this.router=e;this.dashboardService=t;this.auth=i;this.toastr=o}imageApi=O(B);customOptions={loop:!0,dots:!0,navSpeed:700,navText:['<img class="arrow" src="images/Vector1.svg">','<img class="arrow" src="images/Vector.svg">'],responsive:{0:{items:1,nav:!1,dots:!1},576:{items:1,nav:!0,dots:!0},750:{items:1,nav:!0,dots:!1},772:{items:1,nav:!0,dots:!0}},nav:!0,animateIn:"fadeIn",animateOut:"fadeOut",margin:0};backgroundVideo;carousel;ngAfterViewInit(){this.setupVideoBackground(),this.animateSlideContent(),this.setupVideo()}onKeyDown(e){e.key==="ArrowRight"?this.moveToNextSlide():e.key==="ArrowLeft"&&this.moveToPreviousSlide()}moveToNextSlide(){this.carousel&&this.carousel.next()}moveToPreviousSlide(){this.carousel&&this.carousel.prev()}onSlideChange(e){setTimeout(()=>{this.animateSlideContent(e.startPosition)},100)}animateSlideContent(e=0){document.querySelectorAll(".slide-item").forEach(o=>{o.querySelector(".content-boxed")?.classList.remove("active"),o.querySelector(".slide-image")?.classList.remove("active")});let i=document.querySelector(".owl-item.active .slide-item");if(i){let o=i.querySelector(".content-boxed"),l=i.querySelector(".slide-image");o&&o.classList.add("active"),l&&l.classList.add("active")}}setupVideoBackground(){let e=this.backgroundVideo.nativeElement;requestAnimationFrame(()=>{e.addEventListener("ended",()=>{e.currentTime=0,e.play().catch(t=>{console.error("Error while trying to play the video: ",t)})})}),e.addEventListener("canplay",()=>{e.play().catch(t=>{console.error("Error while trying to play the video: ",t)})})}setVideoSpeed(e){this.backgroundVideo.nativeElement.playbackRate=e}setupVideo(){this.setVideoSpeed(.7)}onVideoLoaded(){let e=this.backgroundVideo.nativeElement;e.muted=!0,e.play().catch(t=>{console.error("Error while trying to play the video: ",t)})}sliders=[];ngOnInit(){this.GetAllSlider(),this.startVisitorSession(),console.log("User is a regular visitor. Starting session tracking.")}ngOnDestroy(){this.roles()||this.endVisitorSession()}GetAllSlider(){this.dashboardService.GetAllSliderHome().subscribe({next:e=>{this.sliders=e,this.sliders.length===1?(this.customOptions.nav=!1,this.customOptions.loop=!1):(this.customOptions.nav=!0,this.customOptions.loop=!0)},error:()=>{console.log("Error loading sliders")}})}roles(){let e="http://schemas.microsoft.com/ws/2008/06/identity/claims/role",t=this.auth.getAccessToken();if(!t||typeof t!="string"||t.trim()==="")return!1;try{let o=L(t)[e];return o==="Admin"||o==="Staff"}catch(i){return console.error("Error decoding token:",i),!1}}deleteSlider(e){Y.default.fire({title:"Are you sure?",text:"Do you want to delete this slider?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(t=>{t.isConfirmed&&this.dashboardService.DeleteSliderHome(e).subscribe({next:()=>{this.sliders=this.sliders.filter(i=>i.id!==e),this.toastr.success("Slider deleted successfully")},error:()=>{this.toastr.error("Error deleting slider")}})})}goToUpdateSlider(e){this.router.navigate([`/Dashboard/slider-Home/${e}`])}startVisitorSession(){this.roles()||sessionStorage.getItem("sessionId")||this.dashboardService.startSession().subscribe({next:e=>{console.log("Visitor session started successfully."),sessionStorage.setItem("sessionId",e),sessionStorage.setItem("startTime",new Date().toISOString())},error:e=>{console.error("Error starting session:",e)}})}endVisitorSession(){let e=sessionStorage.getItem("sessionId"),t=sessionStorage.getItem("startTime");if(!e||!t){console.error("Session ID or Start Time not found in sessionStorage.");return}let i=parseInt(e,10);isNaN(i)?console.error("Invalid Session ID stored in sessionStorage."):this.dashboardService.endSession(i).subscribe({next:()=>{console.log("Session ended successfully. Data sent to backend."),sessionStorage.removeItem("sessionId"),sessionStorage.removeItem("startTime")},error:o=>{console.error("Error ending session:",o)}})}static \u0275fac=function(t){return new(t||a)(f(D),f(z),f(j),f(N))};static \u0275cmp=k({type:a,selectors:[["app-home"]],viewQuery:function(t,i){if(t&1&&(b(Z,5),b(ee,5)),t&2){let o;y(o=x())&&(i.backgroundVideo=o.first),y(o=x())&&(i.carousel=o.first)}},hostBindings:function(t,i){t&1&&u("keydown",function(l){return i.onKeyDown(l)},E)},decls:30,vars:3,consts:[["backgroundVideo",""],["carousel",""],["autoplay","","loop","","muted","","playsinline","","preload","auto",1,"background-video",3,"loadeddata"],["src","videos/bg1.webm","type","video/webm"],["src","videos/bg.mp4","type","video/mp4"],["src","images/BG.webp","alt","",1,"bg"],[1,"container"],[1,"hero-section"],[1,"carousel-container","owl-theme","owl-carousel-one"],[3,"changed","options"],["carouselSlide",""],[1,"taif-logo-container"],[1,"logo-char","char-t"],[1,"logo-char","char-a"],[1,"logo-char","char-i"],[1,"logo-char","char-f"],[1,"title2"],[1,"slide-item","horizontal-slide"],[1,"slide-image"],["alt","",1,"pic",3,"src"],[1,"content-boxed"],[1,"te-title"],[1,"margin"],["class","btn btn-danger remove",3,"click",4,"ngIf"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-danger","remove",3,"click"],[1,"btn","btn-warning",3,"click"]],template:function(t,i){if(t&1){let o=_();n(0,"video",2,0),u("loadeddata",function(){return p(o),g(i.onVideoLoaded())}),v(2,"source",3)(3,"source",4),r(),v(4,"img",5),n(5,"div",6)(6,"section",7)(7,"div",8)(8,"owl-carousel-o",9,1),u("changed",function(J){return p(o),g(i.onSlideChange(J))}),T(10,re,1,0,null,10,te),r()()()(),n(12,"div",11)(13,"p",12),s(14,"T"),r(),n(15,"p",13),s(16,"A"),r(),n(17,"p",14),s(18,"I"),r(),n(19,"p",15),s(20,"F"),r()(),n(21,"div",16)(22,"p"),s(23,"T"),r(),n(24,"p"),s(25,"A"),r(),n(26,"p"),s(27,"I"),r(),n(28,"p"),s(29,"F"),r()()}t&2&&(c(8),d("options",i.customOptions),c(2),A(i.sliders),c(2),d("@taifLogoAnimation",void 0),c(9),d("@taifLogoAnimation",void 0))},dependencies:[$,G,Q,H,P],styles:[".admin-dashboard-wrapper[_ngcontent-%COMP%]{margin-top:0;position:fixed;height:100%;z-index:102}.sidebar[_ngcontent-%COMP%]{width:320px;background-color:#2c3e50;color:#fff;padding:20px;box-shadow:2px 0 5px #0000001a;display:flex;flex-direction:column;align-items:center}.sidebar[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:30px;color:#ecf0f1;border-bottom:2px solid #3498db;padding-bottom:10px;width:100%;text-align:center}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;width:100%;height:100%}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:15px}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;padding:10px 15px;display:block;border-radius:5px;transition:background-color .3s ease}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#3498db}"],data:{animation:[R("taifLogoAnimation",[F(":enter",[h({opacity:0}),I("p",[h({opacity:0,transform:"translateY(-20px)"})],{optional:!0}),q([C("1s",h({opacity:1})),I("p",U(950,[C("1s ease-out",h({opacity:1,transform:"translateY(0)"}))]),{optional:!0})])])])]}})};export{K as Home};
